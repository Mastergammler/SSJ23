/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/8.0.2/samples
 */

 plugins {
    id 'native-component'
    id 'cpp'
}

model {
    toolChains {
        clang(Clang){ }
    }
    platforms {
        windows_x86_64 {
            architecture 'x86_64'
        }
    }
    components {
        main(NativeExecutableSpec){
            targetPlatform 'windows_x86_64'
            binaries.all {
                cppCompiler.args '-std=c++20'
                cppCompiler.args '-g'
                cppCompiler.args '-Werror=return-type'
                cppCompiler.args '-Wall'
                cppCompiler.args '-Wpedantic'
                linker.args '-luser32'
                linker.args '-lgdi32'
                linker.args '-lwinmm'
            }
            sources {
                cpp {
                    source {
                        srcDir "src"
                            include "**/*cpp"
                    }
                }
            }
        }
    }
 }

task run(type: Exec) {
    dependsOn 'build'
    doFirst {
        workingDir 'build/exe/main'
            commandLine 'cmd','/c','main.exe'
    }
}
